"0","ASV.nested %>% "
"0","  ungroup() %>% "
"0","  mutate(Step1.cleaned.tibble = map2(Samples, contam.tibble, function(.x,.y){ "
"0","    .x %>%"
"0","      dplyr::group_by (sample) %>%"
"0","      mutate (TotalReadsperSample = sum (nReads)) %>%"
"0","      left_join(.y, by = ""seq_number"") %>%"
"0","      mutate (Updated_nReads = ifelse (!is.na(vector_contamination),  nReads - (ceiling(vector_contamination*TotalReadsperSample)), nReads)) %>%"
"0","      filter (Updated_nReads > 0) %>%"
"0","      ungroup() %>% "
"0","      dplyr::select (sample, seq_number, nReads = Updated_nReads)"
"0","  })) -> ASV.nested"
